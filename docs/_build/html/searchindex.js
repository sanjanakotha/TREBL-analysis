Search.setIndex({"docnames": [".ipynb_checkpoints/examples-checkpoint", ".ipynb_checkpoints/index-checkpoint", ".ipynb_checkpoints/map_refiner-checkpoint", "complexity", "error_correct", "examples", "finder", "index", "initial_map", "map_refiner", "mapping", "modules", "plotting", "preprocess", "umi_deduplicate"], "filenames": [".ipynb_checkpoints/examples-checkpoint.rst", ".ipynb_checkpoints/index-checkpoint.rst", ".ipynb_checkpoints/map_refiner-checkpoint.rst", "complexity.rst", "error_correct.rst", "examples.rst", "finder.rst", "index.rst", "initial_map.rst", "map_refiner.rst", "mapping.rst", "modules.rst", "plotting.rst", "preprocess.rst", "umi_deduplicate.rst"], "titles": ["Examples", "TREBL-scripts Documentation", "map_refiner module", "complexity module", "error_correct module", "Examples", "finder module", "TREBL-scripts Documentation", "initial_map module", "map_refiner module", "mapping module", "scripts", "plotting module", "preprocess module", "umi_deduplicate module"], "terms": {"here": [0, 5], "an": [0, 2, 5, 8, 9, 14], "workflow": [0, 5], "us": [0, 1, 2, 4, 5, 7, 9, 12, 14], "trebl": [0, 5], "script": [0, 5, 14], "from": [0, 2, 5, 6, 8, 9, 12, 13, 14], "import": [0, 5], "barcodemapp": [0, 5, 6, 13], "intial": [0, 5], "object": [0, 2, 3, 4, 5, 6, 8, 9, 13, 14], "mapper": [0, 5, 6, 8, 13], "seq_fil": [0, 5, 8, 13], "global": [0, 5], "scratch": [0, 5], "project": [0, 5], "fc_mvslab": [0, 5], "data": [0, 5], "sequenc": [0, 2, 3, 4, 5, 6, 8, 9, 12, 13, 14], "czb_feb2024": [0, 5], "a10_a11": [0, 5], "result": [0, 2, 5, 9, 14], "a10_1_sequ": [0, 5], "txt": [0, 4, 5, 8, 13], "design_file_path": [0, 5, 8], "openproject": [0, 5], "echas": [0, 5], "trebleseq_ismaybethenewcibernam": [0, 5], "a10_sequenc": [0, 5], "v2": [0, 5], "current": [0, 2, 5, 9, 14], "a10_designfil": [0, 5], "csv": [0, 2, 5, 8, 9, 14], "bc_name": [0, 5, 6], "ad": [0, 2, 5, 6, 9, 12], "ad_bc": [0, 5], "rptr_bc": [0, 5], "preced": [0, 4, 5, 6, 8], "ggctagc": [0, 5], "cgcgcc": [0, 5], "ctcgag": [0, 5], "post": [0, 4, 5, 6, 8], "length": [0, 4, 5, 6, 8], "120": [0, 5, 6], "11": [0, 5], "14": [0, 5], "reverse_compl": [0, 4, 5, 8, 13], "true": [0, 2, 5, 6, 8, 9, 12, 14], "creat": [0, 2, 4, 5, 6, 8, 9, 12], "mapped_df": [0, 5], "create_map": [0, 5, 8, 13], "save": [0, 2, 4, 5, 9, 12, 13, 14], "parquet": [0, 5, 13], "slow": [0, 5], "big": [0, 5], "dataset": [0, 3, 5], "save_parquet": [0, 5, 13], "sanjana": [0, 5], "sk_current_a10_1_tbcraw_v2": [0, 5], "map_refin": [0, 1, 5, 7, 11], "maprefin": [0, 2, 5, 9], "initi": [0, 2, 5, 6, 8, 9, 13, 14], "db_path": [0, 2, 3, 5, 8, 9, 14], "duckdb": [0, 2, 5, 8, 9, 14], "analysis_test": [0, 5], "db": [0, 5, 8], "col": [0, 5, 14], "reads_threshold": [0, 2, 5, 9], "50": [0, 5], "column_pair": [0, 2, 5, 9], "1": [0, 2, 5, 6, 9, 13], "match": [0, 5], "start": [0, 5, 13], "desir": [0, 5], "file": [0, 2, 4, 5, 8, 9, 12, 13, 14], "s": [0, 1, 5, 7, 8, 13, 14], "refine_map_from_parquet": [0, 5], "final": [0, 5], "save_map": [0, 2, 5, 9], "map5": [0, 5], "final_map": [0, 5], "loss": [0, 2, 5, 9], "tabl": [0, 2, 5, 8, 9, 12, 14], "loss_tabl": [0, 5], "losstabl": [0, 5], "welcom": [1, 7], "map": [1, 2, 4, 7, 8, 9, 13, 14], "modul": [1, 7, 11], "gener": [1, 2, 7, 9, 14], "preliminari": [1, 7], "2": [1, 7], "filter": [1, 2, 7, 9], "see": [1, 7], "exampl": [1, 6, 7, 8, 13], "full": [1, 7, 8, 14], "index": [1, 7], "search": [1, 7], "page": [1, 7], "class": [2, 3, 4, 6, 8, 9, 14], "bc_object": [2, 6, 8, 9, 14], "map_ord": [2, 9], "none": [2, 4, 8, 9, 12, 13], "step_nam": [2, 3, 8, 9, 14], "descriptor": [2, 9, 14], "design_fil": [2, 9], "output_figures_path": [2, 9, 12], "min_fraction_major_target": [2, 9], "0": [2, 6, 9, 13], "9": [2, 9], "manual_ec_threshold": [2, 9], "umi_object": [2, 8, 9], "sourc": [2, 3, 4, 6, 8, 9, 12, 13, 14], "base": [2, 3, 6, 8, 9, 14], "A": [2, 3, 8, 9], "refin": [2, 9], "made": [2, 9], "through": [2, 9], "initialmapp": [2, 8, 9], "default_map_ord": [2, 9, 12], "qualiti": [2, 6, 8, 9], "error_correct": [2, 9, 11], "group": [2, 4, 9, 12], "threshold": [2, 9], "barcode_exist": [2, 9], "unique_target": [2, 9], "design": [2, 8, 9], "apply_whitelist": [2, 9], "output_dir": [2, 4, 9, 14], "prev_tabl": [2, 9], "appli": [2, 9, 13], "umi_tool": [2, 4, 9], "whitelist": [2, 4, 9, 12], "previou": [2, 9], "replac": [2, 8, 9], "barcod": [2, 3, 4, 6, 8, 9, 12, 13, 14], "canon": [2, 4, 9, 12], "ones": [2, 9], "recalcul": [2, 9], "flag": [2, 8, 9], "new": [2, 4, 9, 12, 14], "prefix": [2, 4, 8, 9], "previous_t": [2, 9], "remov": [2, 9], "row": [2, 4, 8, 9, 12, 14], "where": [2, 4, 9, 14], "ani": [2, 9], "column": [2, 4, 6, 8, 9, 12, 13, 14], "except": [2, 9], "null": [2, 9], "empti": [2, 9], "string": [2, 9], "check_exist": [2, 9], "check_table_nam": [2, 9], "close_connect": [2, 9], "create_design": [2, 9], "keep": [2, 9, 13, 14], "onli": [2, 4, 8, 9, 13], "create_error_correct": [2, 9], "perform": [2, 9, 14], "error": [2, 9], "correct": [2, 9], "fastq": [2, 4, 8, 9, 13, 14], "updat": [2, 6, 9], "databas": [2, 8, 9], "create_group": [2, 9], "quality_design": [2, 9, 14], "create_initi": [2, 9], "parquet_path": [2, 9], "create_qu": [2, 9], "all": [2, 4, 6, 8, 9, 12, 14], "_qual": [2, 9], "ar": [2, 4, 9], "create_threshold": [2, 9], "create_unique_target": [2, 9], "For": [2, 9, 13], "each": [2, 9, 13, 14], "key_col": [2, 9], "target_col": [2, 9], "pair": [2, 9], "independ": [2, 9], "kei": [2, 9], "most": [2, 9], "abund": [2, 9], "target": [2, 9], "account": [2, 9], "self": [2, 8, 9, 14], "read": [2, 4, 8, 9, 12, 13, 14], "Then": [2, 9], "pass": [2, 9, 12], "generate_fastq_for_whitelist": [2, 9], "suffix": [2, 9, 14], "_barcodes_extract": [2, 9], "synthet": [2, 9], "concaten": [2, 4, 9, 14], "check": [2, 9], "paramet": [2, 4, 6, 8, 9, 12, 13, 14], "str": [2, 4, 6, 8, 9, 12, 13, 14], "path": [2, 4, 8, 9, 12, 13, 14], "option": [2, 4, 6, 8, 9, 12], "directori": [2, 4, 9, 12], "default": [2, 4, 6, 8, 9, 12], "work": [2, 9, 13], "filenam": [2, 9], "name": [2, 4, 6, 8, 9], "instead": [2, 9, 12], "return": [2, 4, 6, 8, 9, 12, 13, 14], "type": [2, 4, 6, 8, 9, 12, 13], "get_map_df": [2, 9], "map_nam": [2, 9], "insert_prefix": [2, 9], "merge_design": [2, 8, 9], "merg": [2, 8, 9, 14], "provid": [2, 8, 9], "info": [2, 9], "seq": [2, 9, 13], "plot_all_whitelists_from_summari": [2, 9, 12], "summary_df": [2, 9, 12], "n_col": [2, 4, 9, 12], "4": [2, 4, 9, 12, 13], "dpi": [2, 4, 9, 12], "300": [2, 4, 9, 12], "plot": [2, 4, 9, 11], "summari": [2, 4, 9, 12], "multipl": [2, 4, 9, 12, 13, 14], "precomput": [2, 9, 12], "again": [2, 9, 12], "pd": [2, 4, 6, 9, 12, 13], "datafram": [2, 4, 6, 8, 9, 12, 13, 14], "summarize_canonical_subsequ": [2, 9, 12], "must": [2, 9, 12], "contain": [2, 4, 6, 8, 9, 12, 14], "num_merg": [2, 9, 12], "largest_count": [2, 9, 12], "rest_count": [2, 9, 12], "int": [2, 4, 6, 8, 9, 12, 13], "number": [2, 4, 8, 9, 12, 13], "panel": [2, 4, 9, 12], "per": [2, 4, 9, 12, 13, 14], "figur": [2, 4, 9, 12], "fig": [2, 4, 9, 12], "matplotlib": [2, 4, 9, 12], "plot_error_correct": [2, 9, 12], "save_dir": [2, 9, 12], "summar": [2, 4, 9, 12], "count": [2, 9, 12, 14], "subsequ": [2, 9, 12], "produc": [2, 8, 9, 12], "output": [2, 4, 9, 12, 13, 14], "bool": [2, 4, 8, 9, 12, 13], "whether": [2, 4, 8, 9, 12, 13], "size": [2, 4, 9, 12], "plot_loss": [2, 9], "ax": [2, 4, 9, 12], "palett": [2, 9, 12], "rocket_r": [2, 9], "text_offset": [2, 9, 12], "show_background": [2, 9, 12], "across": [2, 9], "step": [2, 9], "show": [2, 9], "total": [2, 9], "vs": [2, 4, 9], "uniqu": [2, 9, 14], "add": [2, 9], "numer": [2, 9], "label": [2, 9], "end": [2, 9], "bar": [2, 4, 9, 13], "save_path": [2, 9, 12], "exist": [2, 9, 14], "axi": [2, 9, 12], "draw": [2, 9], "seaborn": [2, 9], "color": [2, 9], "The": [2, 4, 9], "plot_reads_histogram": [2, 9, 12], "kwarg": [2, 9, 12], "refine_map_from_db": [2, 9], "save_nam": [2, 9], "should_check_exist": [2, 9], "fals": [2, 9], "save_loss_t": [2, 9], "output_csv_path": [2, 9], "process": [2, 8, 9], "If": [2, 4, 8, 9, 12], "thi": [2, 8, 9], "percentag": [2, 9], "map_path": [2, 9], "show_tabl": [2, 3, 9, 14], "complexitycheck": 3, "step1_map_nam": [3, 14], "step_suffix": 3, "barcode_group": 3, "handl": 3, "preprocess": [3, 11], "extract": [3, 4, 6, 8, 13], "analysi": 3, "count_overlap": 3, "count_overlap_one_barcode_group": 3, "concatenate_fastq": 4, "input_fastq_list": 4, "singl": 4, "temporari": 4, "convert_txt_to_whitelist_mapping_df_from_path": 4, "whitelist_path": 4, "text": [4, 13], "build": 4, "ident": 4, "old": 4, "function": 4, "revers": [4, 8, 13], "complement": [4, 8, 13], "origin": [4, 14], "plot_all_whitelist": 4, "grid": 4, "layout": 4, "summarize_whitelist": 4, "list": [4, 8, 13], "rc_and_swap": 4, "given": 4, "preceder_rc": 4, "post_rc": 4, "mode": 4, "rc": 4, "run_whitelist_on_concat_domain": 4, "fastq_path": [4, 14], "set_cell_numb": 4, "run": [4, 8, 13, 14], "simplifi": 4, "log": [4, 12], "basenam": 4, "figsiz": 4, "16": 4, "side": 4, "chart": 4, "histogram": [4, 12], "scatter": 4, "largest": 4, "member": 4, "sum": 4, "smaller": 4, "whose": 4, "pre": 4, "arrai": [4, 14], "like": 4, "tupl": 4, "add_barcod": 6, "seq_df": 6, "between": 6, "follow": 6, "pattern": 6, "dask": [6, 13], "bc_length": 6, "maximum": 6, "df": [6, 12, 13], "aaaxxxccc": 6, "aaayyyccc": 6, "aaa": 6, "ccc": 6, "3": 6, "ad_qual": 6, "xxx": 6, "yyi": 6, "add_multiple_barcod": 6, "defin": [6, 8], "add_umi": 6, "umi_length": 6, "12": 6, "first": [6, 8], "umi": [6, 8, 14], "umi_qu": 6, "initial_map": [7, 11], "umi_dedupl": [7, 11], "dna": [8, 13], "them": 8, "input": [8, 13], "befor": 8, "step1": [8, 14], "pipelin": [8, 14], "create_test_map": 8, "test_n_read": 8, "100": 8, "limit": 8, "test": 8, "extract_barcod": 8, "comput": 8, "extract_umi": 8, "its": 8, "preview_map": 8, "preview": 8, "5": 8, "panda": [8, 13], "read_fastq": 8, "set": 8, "reverse_complement_fastq": 8, "complex": 11, "finder": 11, "table_prefix_with_descriptor": 12, "plot_loss_help": 12, "map_df": 12, "scale": 12, "least": 12, "dict": 12, "addit": 12, "keyword": 12, "argument": 12, "sn": 12, "histplot": 12, "load_and_shorten_fil": 13, "load": 13, "gzip": 13, "everi": 13, "4th": 13, "line": 13, "reverse_complement_seri": 13, "seri": 13, "atgc": 13, "gattaca": 13, "gcat": 13, "tgtaatc": 13, "dtype": 13, "progress": [13, 14], "mapped_barcod": 13, "shorten_seq_fil": 13, "infil": 13, "outfil": 13, "chunk_siz": 13, "400000": 13, "fastest": 13, "2nd": 13, "record": 13, "plain": 13, "gz": [13, 14], "onc": 13, "time_it": 13, "func": 13, "decor": 13, "print": 13, "how": 13, "long": 13, "method": 13, "take": 13, "umidedupl": 14, "output_path": 14, "refined_map_suffix": 14, "unifi": 14, "dedupl": 14, "combin": 14, "simpl": 14, "tool": 14, "align_sort_and_deduplicate_umi": 14, "counts_per_umi": 14, "generate_barcode_fasta_and_index": 14, "_barcod": 14, "separ": 14, "generate_fastq": 14, "_umi_extract": 14, "table_prefix": 14, "id": 14, "track": 14, "tqdm": 14, "merge_complex_with_step1_map": 14, "merge_simple_with_step1_map": 14, "inner": 14, "run_both_dedupl": 14, "run_simple_dedupl": 14, "run_umi_tools_dedupl": 14, "save_simple_dedupl": 14, "unique_umis_per_barcod": 14, "distinct": 14, "fastp_summary_df": 14, "run_fastp": 14, "input_dir": 14, "script_path": 14, "savio_job": 14, "fastp": 14, "sh": 14, "submit": 14, "slurm": 14, "job": 14, "folder": 14, "should": 14, "written": 14}, "objects": {"": [[3, 0, 0, "-", "complexity"], [4, 0, 0, "-", "error_correct"], [6, 0, 0, "-", "finder"], [8, 0, 0, "-", "initial_map"], [9, 0, 0, "-", "map_refiner"], [12, 0, 0, "-", "plotting"], [13, 0, 0, "-", "preprocess"], [14, 0, 0, "-", "umi_deduplicate"]], "complexity": [[3, 1, 1, "", "ComplexityChecker"]], "complexity.ComplexityChecker": [[3, 2, 1, "", "count_overlap"], [3, 2, 1, "", "count_overlap_one_barcode_group"], [3, 2, 1, "", "show_tables"]], "error_correct": [[4, 3, 1, "", "concatenate_fastqs"], [4, 3, 1, "", "convert_txt_to_whitelist_mapping_df_from_path"], [4, 3, 1, "", "plot_all_whitelists"], [4, 3, 1, "", "rc_and_swap"], [4, 3, 1, "", "run_whitelist_on_concat_domains"], [4, 3, 1, "", "summarize_whitelist"]], "finder": [[6, 1, 1, "", "Barcode"], [6, 3, 1, "", "add_barcode"], [6, 3, 1, "", "add_multiple_barcodes"], [6, 3, 1, "", "add_umi"]], "initial_map": [[8, 1, 1, "", "InitialMapper"]], "initial_map.InitialMapper": [[8, 2, 1, "", "create_map"], [8, 2, 1, "", "create_test_map"], [8, 2, 1, "", "extract_barcodes"], [8, 2, 1, "", "extract_umi"], [8, 2, 1, "", "merge_design"], [8, 2, 1, "", "preview_map"], [8, 2, 1, "", "read_fastq"], [8, 2, 1, "", "reverse_complement_fastq"]], "map_refiner": [[9, 1, 1, "", "MapRefiner"]], "map_refiner.MapRefiner": [[9, 4, 1, "", "DEFAULT_MAP_ORDER"], [9, 2, 1, "", "apply_whitelist"], [9, 2, 1, "", "barcode_exists"], [9, 2, 1, "", "check_exists"], [9, 2, 1, "", "close_connection"], [9, 2, 1, "", "create_designed"], [9, 2, 1, "", "create_error_corrected"], [9, 2, 1, "", "create_grouped"], [9, 2, 1, "", "create_initial"], [9, 2, 1, "", "create_quality"], [9, 2, 1, "", "create_thresholded"], [9, 2, 1, "", "create_unique_target"], [9, 2, 1, "", "generate_fastq_for_whitelist"], [9, 2, 1, "", "get_map_df"], [9, 2, 1, "", "merge_design"], [9, 2, 1, "", "plot_all_whitelists_from_summary"], [9, 2, 1, "", "plot_error_correction"], [9, 2, 1, "", "plot_loss"], [9, 2, 1, "", "plot_reads_histogram"], [9, 2, 1, "", "refine_map_from_db"], [9, 2, 1, "", "save_loss_table"], [9, 2, 1, "", "save_map"], [9, 2, 1, "", "show_tables"]], "plotting": [[12, 3, 1, "", "plot_all_whitelists_from_summary"], [12, 3, 1, "", "plot_error_correction"], [12, 3, 1, "", "plot_loss_helper"], [12, 3, 1, "", "plot_reads_histogram"]], "preprocess": [[13, 3, 1, "", "load_and_shorten_files"], [13, 3, 1, "", "reverse_complement"], [13, 3, 1, "", "reverse_complement_series"], [13, 3, 1, "", "save_parquet"], [13, 3, 1, "", "shorten_seq_file"], [13, 3, 1, "", "time_it"]], "umi_deduplicate": [[14, 1, 1, "", "UMIDeduplicator"], [14, 3, 1, "", "fastp_summary_df"], [14, 3, 1, "", "run_fastp"]], "umi_deduplicate.UMIDeduplicator": [[14, 2, 1, "", "align_sort_and_deduplicate_umis"], [14, 2, 1, "", "counts_per_umi"], [14, 2, 1, "", "generate_barcode_fasta_and_index"], [14, 2, 1, "", "generate_fastq"], [14, 2, 1, "", "merge_complex_with_step1_map"], [14, 2, 1, "", "merge_simple_with_step1_map"], [14, 2, 1, "", "run_both_deduplications"], [14, 2, 1, "", "run_simple_deduplication"], [14, 2, 1, "", "run_umi_tools_deduplication"], [14, 2, 1, "", "save_simple_deduplication"], [14, 2, 1, "", "show_tables"], [14, 2, 1, "", "unique_umis_per_barcodes"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:function", "4": "py:attribute"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "function", "Python function"], "4": ["py", "attribute", "Python attribute"]}, "titleterms": {"exampl": [0, 5], "preliminari": [0, 5], "map": [0, 5, 10], "refin": [0, 5], "trebl": [1, 7], "script": [1, 7, 11], "document": [1, 7], "workflow": [1, 7], "indic": [1, 7], "tabl": [1, 7], "map_refin": [2, 9], "modul": [2, 3, 4, 6, 8, 9, 10, 12, 13, 14], "complex": 3, "error_correct": 4, "finder": 6, "content": 7, "initial_map": 8, "plot": 12, "preprocess": 13, "umi_dedupl": 14}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1, "sphinx": 56}})